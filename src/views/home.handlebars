<style type="text/css">
.navbar{
  display: flex; 
  width:100%; 
  justify-content: flex-start; 
  background-color:#969696;
  align-items: center;
}
ul li {
  list-style: none;
}
ul li a{
  margin: 0px 30px 0px 0px;
  padding: 0px;
}
.profile li ul{
  display: none;
  position: absolute;
  min-width: 140px;
  background-color: #969696;
  z-index: 1;
}
.profile{
  margin: 0px;
  padding: 0px;
}
.icono-grande{
  margin-left: 20px;
  font-size: 35px;
}
.profile li:hover >ul{
  display: block;
}

</style>

<div class="navbar">
  <ul class="profile">
    <li><i class="fa-solid fa-id-card icono-grande"></i>
      <ul>
        <li><a>Hola <b>{{user.firstname}}</b></a></li>
        <li><a>{{user.email}}</a></li>
        <li><a>Rol: {{user.role}}</a></li>
        <li><button 
  class="btn btn-danger" 
  style="
  position: relative;
  display: inline-block;
  width:120px;
  height:30px;
  color: #fff;
  border: none;
  margin-bottom: 10px;"> 
    <a 
      href="/session/logout"
      style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: transparent;
      text-decoration: none;
      color: white;
      line-height: 1;">
      Salir
</button></a></li>
      </ul>
    </li>
  </ul>
</div>
<hr />
<div align="center">
  {{#if paginateInfo.hasPrevPage}}
    <a href="{{paginateInfo.prevLink}}">Anterior</a>
  {{/if}}
  {{#each paginateInfo.totalPages}}
    <a href="{{this.link}}">{{this.page}}</a>
  {{/each}}
  {{#if paginateInfo.hasNextPage}}
    <a href="{{paginateInfo.nextLink}}">Siguiente</a>
  {{/if}}
</div>
<hr />
<table class="table table-dark table-striped">
  <thead>
    <tr>
      <td></td>
      <td><strong>Producto</strong></td>
      <td><strong>Descripción</strong></td>
      <td><strong>Precio</strong></td>
      <td><strong>Código</strong></td>
      <td><strong>Stock</strong></td>
      <td><strong>Categoría</strong></td>
    </tr>
  </thead>
  <tbody>
    {{#each products}}
      <tr>
        <td><button
            class="btn btn-primary"
            onclick="addProductToCart('{{this._id}}')"
          >AddToCart</button></td>
        <td>{{this.title}}</td>
        <td>{{this.description}}</td>
        <td>{{this.price}}</td>
        <td>{{this.code}}</td>
        <td>{{this.stock}}</td>
        <td>{{this.category}}</td>
      </tr>
    {{/each}}
  </tbody>
</table>

<script>
  addProductToCart = (pid) => { fetch(`/api/carts`, { method: 'post' })
  .then(result => result.json()) .then(result => { if (result.status ===
  'error') throw new Error(result.error) return result.payload._id }) .then(cid
  => fetch(`/api/carts/${cid}/product/${pid}`, { method: 'post' }) )
  .then(result => result.json()) .then(result => { if (result.status ===
  'error') throw new Error(result.error) alert(`Ok. Todo salió bien! :)\nEl
  producto se agregó al carrito con id=${result.payload._id}!`) }) .catch(err =>
  alert(`Ocurrió un error :(\n${err}`)) }
</script>